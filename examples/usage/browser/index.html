<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Promptbook for NPI</title>
    </head>
    <body>
        <textarea id="input">
      Pavol
      Jirka
      Ivana
    </textarea
        >
        <textarea id="output"></textarea>
        <textarea id="execution-report"></textarea>
        <input type="text" id="api-key" />
        <textarea id="promptbook">

      # ‚ú® Example prompt

    Show how to use a simple prompt with no parameters.

    -   PROMPTBOOK VERSION 1.0.0
    -   MODEL VARIANT Chat
    -   MODEL NAME `gpt-3.5-turbo`
    -   OUTPUT PARAMETER `{greeting}`


    ## üí¨ Prompt

    ```text
    Hello
    ```

    `-> {output}`

    </textarea
        >
        <button id="run">Run</button>

        <script type="module">
            // TODO: This is not working, because the modules are not imported correctly.

            // TODO: [üçì][ü§£] Auto update version
            import * as promptbookExecuteJavascriptModule from 'https://unpkg.com/@promptbook/execute-javascript@0.47.0-0';
            import * as promptbookCoreModule from 'https://unpkg.com/@promptbook/core';
            import * as spacetrimModule from 'https://unpkg.com/spacetrim';
            // import * as waitasecondModule from 'https://unpkg.com/waitasecond';
            // import * as openaiModule from 'https://unpkg.com/openai';

            console.log({
                promptbookExecuteJavascriptModule,
                promptbookCoreModule,
                spacetrimModule,
                // waitasecondModule,
                // openaiModule,
            });
        </script>

        <!--

        <script type="module">
            import * as spacetrim2 from 'https://unpkg.com/spacetrim';
            console.log({ spacetrim2 });
        </script>
        <script src="https://unpkg.com/@promptbook/execute-javascript@0.47.0-0"></script>
        <script type="module">
            import * as hello from 'https://unpkg.com/@promptbook/execute-javascript@0.47.0-0';
            console.log({ hello });
        </script>
        <script type="module">

             TODO: [üçì] Uncomment - This must work OR be removed as example completely
                    @see https://github.com/webgptorg/promptbook/discussions/74

            import {
                createPipelineExecutor,
                compilePipeline,
            } from 'https://unpkg.com/@promptbook/core@0.47.0-0';
            import { JavascriptEvalExecutionTools } from 'https://unpkg.com/@promptbook/execute-javascript@0.47.0-0';
            import { OpenAiExecutionTools } from 'https://unpkg.com/@promptbook/openai@0.47.0-0';
            import {
                executionReportJsonToString,
            } from 'https://unpkg.com/@promptbook/utils@0.47.0-0';

            const inputElement = document.getElementById('input');
            const outputElement = document.getElementById('output');
            const executionReportElement = document.getElementById('execution-report');
            const apiKeyElement = document.getElementById('api-key');
            const promptbookElement = document.getElementById('promptbook');
            const runElement = document.getElementById('run');


            runElement.addEventListener('click', run);

            async function run() {
                console.log(`üöÄ Running`);

                const promptbook = await compilePipeline(promptbookElement.value, {llm:});

                console.log(promptbook);

                const tools = {
                    llm: new OpenAiExecutionTools(
//            <- TODO: [üß±] Implement in a functional (not new Class) way
{
                        isVerbose: true,
                        apiKey: `xxx`,
                    }),
                    script: [
                        new JavascriptEvalExecutionTools(
{
                            isVerbose: true,
                        }),
                    ],
                    userInterface: null,
                };

                const pipelineExecutor = createPipelineExecutor({ pipeline, tools });

                const inputParameters = { word: 'cat' };
                const { isSuccessful, errors, outputParameters, executionReport } = await pipelineExecutor(
                    inputParameters,
                ).asPromise();

                console.info(outputParameters);



                const executionReportString = executionReportJsonToString(executionReport);

            
            }
        </script>
        -->
    </body>
</html>
