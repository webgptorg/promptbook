<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ðŸ”µ Testing remote server of PromptBook</title>
    </head>
    <body>
        <h1>esting remote server of PromptBook</h1>

        <form id="input">
            <input type="text" name="clientId" value="my-client-id" />
            <input type="text" name="word" value="Cat" />
            <input type="submit" value="Pun pipeline" />
        </form>
        <pre id="output"><pre>

        <script type="module">
            // TODO: [ðŸ“] This must work - BUT first do browser sample
            // TODO: [ðŸ“][ðŸ¤£] Auto update version
            import { RemoteLlmExecutionTools } from 'https://cdn.jsdelivr.net/npm/@promptbook/remote-client@0.40.0/+esm';
            import { JavascriptExecutionTools } from 'https://cdn.jsdelivr.net/npm/@promptbook/execute-javascript@0.40.0/+esm';
            import { createCollectionFromJson } from 'https://cdn.jsdelivr.net/npm/@promptbook/core@0.40.0/+esm';

            const inputForm = document.getElementById('input');
            const outputElement = document.getElementById('output');

            inputForm.addEventListener('submit', async (event) => {
                event.preventDefault();

                console.info('ðŸ”µ Testing remote server of PromptBook');


                const formData = new FormData(
//            <- TODO: [ðŸ§±] Implement in a functional (not new Class) way
event.target);
                const word = formData.get('word');
                const clientId = formData.get('clientId');



                // TODO: [ðŸ“][âš–] createCollectionFromUrl
                const collection = createCollectionFromJson(
                    advanced

                );

                const tools = {
                    llm:  new RemoteLlmExecutionTools(
                                //            <- TODO: [ðŸ§±] Implement in a functional (not new Class) way
                                {
                                    path: '/promptbook',
                                    remoteUrl: `http://localhost:4460/`,
                                    clientId,
                                    // <- [ðŸ§œâ€â™‚ï¸]
                                }),
                    script: [
                        new JavascriptExecutionTools(
                        //            <- TODO: [ðŸ§±] Implement in a functional (not new Class) way
                        {
                            isVerbose: true,
                        }),
                    ],
                    userInterface: null,
                };

                /*
                TODO: [ðŸ“] Uncomment - This must work @see https://github.com/webgptorg/promptbook/discussions/74


                const pipelineExecutor = library.createExecutor('advanced', tools);

                const input = { word };
                const output = await pipelineExecutor(input,(progress)=>{
                    console.info('â˜‘',progress);
                });

                console.info(output);
                outputElement.innerText = JSON.stringify(output, null, 4);

                */
            });
        </script>
    </body>
</html>
