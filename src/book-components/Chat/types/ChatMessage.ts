import { Message } from '../../../types/Message';
import type { id, string_markdown } from '../../../types/typeAliases';

/**
 * Represents a single message within a chat interface.
 *
 * This type extends the base `Message` type by omitting internal routing fields
 * and adding chat-specific properties like markdown content and generation status.
 *
 * @public exported from `@promptbook/components`
 */
export type ChatMessage = Omit<Message<id>, 'direction' | 'recipients' | 'threadId' | 'metadata'> & {
    /**
     * Force the channel to be 'PROMPTBOOK_CHAT'
     *
     * @default 'PROMPTBOOK_CHAT'
     */
    channel?: 'PROMPTBOOK_CHAT';

    /**
     * The content of the message with optional markdown formatting
     */
    content: string_markdown;

    /**
     * Whether the message is complete (for example, if it's still being generated by an AI)
     *
     * @default true
     */
    isComplete?: boolean;

    /**
     * The expected answer for the message (used for testing or validation)
     */
    expectedAnswer?: string;

    /**
     * Indicates if the message was sent via a voice call
     */
    isVoiceCall?: boolean;

    /**
     * Optional file attachments
     */
    attachments?: Array<{
        /**
         * The name of the file
         */
        name: string;

        /**
         * The type of the file
         */
        type: string;

        /**
         * The URL where the file is stored
         */
        url: string;
    }>;
};

/**
 * TODO: Make all fields readonly
 * TODO: Delete `expectedAnswer` from ChatMessage
 * TODO: Rename `date` into `created`+`modified`
 */
